import * as express from "express"
import * as needle from "needle"
import { HttpRequest } from "../models/http-request";

export class Controller {
    router: express.Router;
    
    constructor() {
        this.router = express.Router();
    }

    async get(req: HttpRequest, next: express.NextFunction, callback: (status: number, body: JSON) => void) {
        needle.get(req.url(), (error, response, body) => {
            if(error) {
                next(error)
            }
            try {
                const status = response.statusCode || 500;
                callback(status, body as JSON)
            } catch(error) {
                next(error)
            }
        })
    }
}